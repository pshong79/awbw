<div class="container-fluid width search-curriculum-page">
  <div class="row">
    <div class="col-md-12 col-lg-8 width">
      <div class="entry-content">
        <h2 class="normal">My bookmarks</h2><br/>
      </div>
    </div>
  </div>

  <%= form_tag('/bookmarks', method: :get) do %>
    <!-- ####### Filter Section ####### -->
    <div class="row">
    <div class='search-boxes'>
      <div class="search-field-row col-md-4">
        <%= label_tag "Title" %>
        <div class="search-input-wrapper" style="position: relative; display: inline-block; width: 100%;">
          <%= text_field_tag :title, params[:title], class: 'search', style: 'padding-right: 30px;' %>
          <div class="submit-div" style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); cursor: pointer;">
            <i class='fa fa-search'></i>
          </div>
        </div>
      </div>
      <div class='search-field-row col-md-4'>
        <%= label_tag "Keywords" %>
        <div class="search-input-wrapper" style="position: relative; display: inline-block; width: 100%;">
          <%= text_field_tag :query, params[:query], class: 'search', style: 'padding-right: 30px;' %>
          <div class="submit-div" style="position: absolute; right: 5px; top: 50%; transform: translateY(-50%); cursor: pointer;">
            <i class='fa fa-search'></i>
          </div>
        </div>
      </div>

      <div class='search-field-row col-md-4'>
        <%= render 'workshops/windows_type_fields', windows_types: @windows_types %>
        <%= link_to 'Clear filters', bookmarks_path %>
      </div>

      <div class="col-md-12 mb-3"></div>
      <div class='sort-options'>
        <br>
        <div class='sortable-label'>
          <b>Sort by:</b>
        </div>
        <div class='sortable-group'>
          <%= render 'sortable_fields', sortable_fields: @sortable_fields %>
        </div>
      </div>
    </div>
  </div>
  <% end %>

  <div class="row">
     <div class="col-md-12 col-lg-12 width" >

       <div class='list-group'>
         <% if @bookmarks.any? %>
           <div id="bookmarks-list">
             <% @bookmarks.each do |bookmark| %>
               <%= render 'bookmarks/flex',
                          bookmark: bookmark,
                          workshop: bookmark.bookmarkable.decorate,
                          breadcrumb: 'My Bookmarks',
                          link_route: workshop_path(bookmark.bookmarkable_id),
                          new_bookamrk: @new_bookmark %>
             <% end %>
           </div>

           <div class='btn-container'>
             <!-- ##### Will Paginate #### -->
             <div id="infinite-scrolling" class="hide">
               <%= will_paginate @bookmarks%>
             </div>

             <% if @bookmarks.next_page %>
               <div class="btn_container"><br/>
                 <div id="load_more" class="btn btn-primary btn--small">
                   Load More
                 </div>
               </div>
             <% end %>
           </div>
         <% else %>
           Your search returned no results.  Please try again.
         <% end %>

       </div>

     </div>
   </div>
</div>

<script>
    $('.submit-div').click(function() {
        $(this).closest('form').submit();
    });

    document.addEventListener("DOMContentLoaded", function() {
        document.querySelectorAll(".category-checkbox").forEach(function(checkbox) {
            checkbox.addEventListener("change", function() {
                this.form.submit();
            });
        });
    });
</script>