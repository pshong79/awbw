<% bookmarkable = bookmark.bookmarkable.decorate %>

<div
  id="bookmarkable-<%= bookmarkable.id %>"
  class="
    flex flex-col md:flex-row <%= "admin-only bg-blue-100" if bookmarkable.inactive? %> border-b
    border-gray-200 list-group-item-custom gap-4 py-4 mb-0
  "
>
  <div
    id="bookmarkable-<%= bookmarkable.id %>-anchor"
    style="position: relative; top: -200px;"
  ></div>
  <!-- 1️⃣ Bookmark -->
  <%= render "bookmarks/editable_bookmark_icon", resource: bookmarkable.object %>

  <!-- 1️⃣ Image -->
  <div class="flex flex-col items-center w-12">
    <!-- Image -->
    <div class="w-12 h-8 bg-gray-100 rounded overflow-hidden">
      <%= link_to polymorphic_path(bookmarkable) do %>
        <%= image_tag(bookmark.bookmarkable_image_url, class: "object-cover w-full h-full",
                        alt: "#{ bookmarkable.object.class.name } image") %>
      <% end %>
    </div>

    <!-- Type -->
    <div class="mt-1 text-xs text-gray-600 font-medium text-center">
      <%= bookmarkable.object.class.name.titleize.upcase %>
    </div>
  </div>


  <!-- 2️⃣ Title / author / metadata -->
  <div class="flex flex-col gap-1 min-w-[40ch] max-w-[40ch] break-words">
    <h3 class="text-lg font-bold text-gray-800 flex items-center gap-2">
      <%= link_to "#{bookmarkable.title}#{" [HIDDEN]" if bookmarkable.inactive?}",
                  polymorphic_path(bookmarkable),
                  class: "hover:underline",
                  data: { turbo: false, } %>
    </h3>
  </div>

 <!-- 3️⃣ Description -->
 <div class="flex-1 text-sm text-gray-700">
   <div class="text-sm text-gray-600">
     Author:
     <% if bookmark.bookmarkable_type == "Workshop" && bookmarkable.user %>
       <%= link_to bookmarkable.author_name,
                   generate_facilitator_user_path(bookmarkable.user),
                   class: "hover:underline",
                   data: { turbo: false, } %>
     <% elsif bookmark.bookmarkable_type == "Workshop" %>
       <%= bookmarkable.full_name.present? ? bookmarkable.full_name : "Facilitator" %>
     <% elsif bookmarkable.respond_to?(:created_by) %>
       <%= bookmarkable.created_by.present? ? bookmarkable.created_by.name : "User" %>
     <% end %>
   </div>

   <div class="text-sm text-gray-600">
    <span>
      Type/date:
      <% if bookmark.bookmarkable_type == "Workshop" && bookmarkable.windows_type.present? %>
        <%= "#{bookmarkable.windows_type.short_name} - #{bookmarkable.date}" %>
      <% elsif bookmark.bookmarkable_type == "Event" %>
        <%= bookmarkable.date %>
      <% else %>
        <%= bookmarkable.created_at.strftime("%B %d, %Y") %>
      <% end %>
      <% if bookmark.bookmarkable_type == "Workshop" && bookmarkable.workshop_age_ranges.any? %>
        (<%= bookmarkable.workshop_age_ranges.to_sentence %>)
      <% end %>
    </span>
   </div>

   <div class="text-sm text-gray-600">
    <span>
      Bookmarked on:
      <%= bookmark.created_at.strftime("%B %d, %Y") %>
    </span>
   </div>
 </div>
</div>
