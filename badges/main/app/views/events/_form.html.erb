<%= simple_form_for(@event) do |f| %>
  <% f.input :created_by_id, as: :hidden, value: current_user.id %>

  <% if @event.errors.any? %>
    <%= render 'shared/errors', resource: @event %>
  <% end %>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    <div>
      <div>
        <%= f.input :title, label: "Event title", required: true,
                    as: :text,
                    input_html: {
                      rows: 1,
                      value: f.object.title,
                      class: "w-full rounded border-gray-300 shadow-sm px-3 py-2
                      focus:ring-blue-500 focus:border-blue-500" } %>
      </div>
    </div>
    <% if current_user.super_user? %>
      <div class="admin-only bg-blue-100 flex items-center mt-6 md:mt-0">
        <%= f.input :publicly_visible, as: :boolean, label: "Publicly visible?", wrapper_html: { class: "ml-2" } %>
        <%= f.input :featured, as: :boolean, label: "Featured?", wrapper_html: { class: "ml-2" } %>
      </div>
    <% end %>
  </div>

  <div>
    <%= f.input :description,
                as: :text,
                input_html: {
                  rows: 3,
                  class: "w-full rounded border-gray-300 shadow-sm px-3 py-2
                    focus:ring-blue-500 focus:border-blue-500" } %>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 my-12">
    <div>
      <%= f.label :start_date, "Start time", required: true, class: "block font-medium mb-1" %>
      <%= f.text_field :start_date, type: 'datetime-local',
                       class: "w-full rounded border-gray-300 shadow-sm px-3 py-2 focus:ring-blue-500 focus:border-blue-500",
                       value: @event.start_date&.strftime('%Y-%m-%dT%H:%M'),
                       required: true %>
      <% if f.object.errors[:start_date].any? %>
        <p class="text-red-500 text-sm mt-1">
          Start date <%= f.object.errors[:start_date].join(", ") %>
        </p>
      <% end %>
    </div>

    <div>
      <%= f.label :end_date, "End time", required: true, class: "block font-medium mb-1" %>
      <%= f.text_field :end_date, type: 'datetime-local',
                       class: "w-full rounded border-gray-300 shadow-sm px-3 py-2 focus:ring-blue-500 focus:border-blue-500",
                       value: @event.end_date&.strftime('%Y-%m-%dT%H:%M'),
                       required: true %>
      <% if f.object.errors[:end_date].any? %>
        <p class="text-red-500 text-sm mt-1">
          End date <%= f.object.errors[:end_date].join(", ") %>
        </p>
      <% end %>
    </div>

    <div>
      <%= f.label :registration_close_date, "Registration close time", class: "block font-medium mb-1" %>
      <%= f.text_field :registration_close_date, type: 'datetime-local',
                       class: "w-full rounded border-gray-300 shadow-sm px-3 py-2 focus:ring-blue-500 focus:border-blue-500",
                       value: @event.registration_close_date&.strftime('%Y-%m-%dT%H:%M') %>
      <% if f.object.errors[:registration_close_date].any? %>
        <p class="text-red-500 text-sm mt-1">
          Registration close date <%= f.object.errors[:registration_close_date].join(", ") %>
        </p>
      <% end %>
    </div>
  </div>

  <% if show_feature?(:stripe_payments) %>
    <div class="mb-6">
      <div class="flex items-center justify-between gap-2 mb-1">
        <%= f.label :cost, "Event Cost", class: "block font-medium" %>
        <span class="text-sm text-gray-600">Enter $0 if the event is free</span>
      </div>
      <div class="relative">
        <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">$</span>
        <%= f.text_field :cost,
                         type: 'number',
                         step: '0.01',
                         min: '0',
                         placeholder: '0.00',
                         oninput: "if(this.value.includes('.')) { var parts = this.value.split('.'); if(parts[1] && parts[1].length > 2) { this.value = parts[0] + '.' + parts[1].substring(0, 2); } }",
                         class: "w-full rounded border-gray-300 shadow-sm pl-8 pr-3 py-2 focus:ring-blue-500 focus:border-blue-500" %>
      </div>
      <% if f.object.errors[:cost].any? %>
        <p class="text-red-500 text-sm mt-1">
          Cost <%= f.object.errors[:cost].join(", ") %>
        </p>
      <% end %>
    </div>
  <% end %>

  <%= render "shared/form_image_fields", f: f, include_primary_asset: true %>

  <div class="flex items-center justify-between gap-4">
    <div>
      <%= "Created by: #{f.object.created_by.name}" if f.object.created_by %>
    </div>

    <div class="flex gap-4">
      <%= link_to "Delete", @event, class: "btn btn-danger-outline", method: :delete, data: { confirm: "Are you sure?" } %>
      <%= link_to 'Cancel', events_path, class: "btn btn-secondary-outline" %>
      <%= f.button :submit, class: "btn btn-primary" %>
<!--                   class: 'inline-flex items-center gap-2 px-4 py-2 rounded-lg-->
<!--                    transition-colors duration-200 font-medium shadow-sm text-sm-->
<!--                    border border-blue-600 text-grey-600 hover:bg-blue-600 hover:text-white'-->
    </div>
  </div>
<% end %>
