<% resource = Draper.undecorate(resource) %>

<%= tag.span id: dom_id(resource, :bookmark_button), data: {controller: "optimistic-bookmark"} do %>
  <% if resource.bookmarks.any? { |b| b.user_id == current_user.id } %>
    <%= button_to bookmark_path(current_user.bookmark_for(resource)),
                    method: :delete,
                    class: "inline-flex items-center gap-2 px-4 py-2
         border border-gray-500 text-primary rounded-lg
         hover:bg-primary hover:text-white transition-colors duration-200
         font-medium shadow-sm leading-none",
                    data: { 
                      turbo_confirm: "Remove bookmark?",
                      action: "click->optimistic-bookmark#toggle" 
                    } do %>
      <i data-optimistic-bookmark-target="icon" class="fas fa-bookmark text-base flex-shrink-0"></i>
      <span data-optimistic-bookmark-target="text" class="leading-none text-sm py-[2.75px]">Bookmarked</span>
    <% end %>
  <% else %>
    <%= button_to bookmarks_path(bookmark: { bookmarkable_id: resource.id, bookmarkable_type: resource.class.name }),
                    class: "inline-flex items-center gap-2 px-4 py-2
         border border-gray-500 text-primary rounded-lg
         hover:bg-primary hover:text-white transition-colors duration-200
         font-medium shadow-sm leading-none",
                    data: { action: "click->optimistic-bookmark#toggle" } do %>
      <i data-optimistic-bookmark-target="icon" class="far fa-bookmark text-base flex-shrink-0"></i>
      <span data-optimistic-bookmark-target="text" class="leading-none text-sm py-[2.75px]">Bookmark</span>
    <% end %>
  <% end %>
<% end %>
