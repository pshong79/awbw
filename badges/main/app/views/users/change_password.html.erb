<div class="flex items-center justify-center">
  <div class="w-full max-w-md bg-white rounded-2xl shadow-lg mt-8 p-8">
    <h2 class="text-2xl font-semibold text-center text-gray-800 mb-6">Change your current password</h2>

    <%= simple_form_for :user,
                        url: update_password_path,
                        method: :post,
                        html: { class: "space-y-4" } do |f| %>

      <!-- CURRENT PASSWORD -->
      <% reset_link =
         link_to "Log out and reset it.",
                 destroy_user_session_path,
                 class: "text-blue-600 hover:underline",
                 data: {
                   turbo_method: :delete,
                   confirm: "This will log you out and send you to the password reset page. Continue?"
                 } %>
      <div class="flex flex-col relative"
           data-controller="password-toggle">
        <%= f.input :current_password,
                    as: :password,
                    required: true,
                    autocomplete: "current-password",
                    autocorrect: "off",
                    autocapitalize: "off",
                    spellcheck: "false",
                    hint: "Don't remember your password? #{reset_link}".html_safe,
                    input_html: {
                      class: "password-field rounded-md border-gray-300 shadow-sm p-2 pr-10",
                      data: { password_toggle_target: "input" }
                    } %>

        <button
          type="button"
          class="toggle-password"
          data-action="password-toggle#toggle"
          aria-label="Toggle password visibility">
          <i class="fa fa-eye" data-password-toggle-target="icon"></i>
        </button>
      </div>

      <!-- NEW PASSWORD -->
      <div class="flex flex-col mt-6 pt-6">
        <div class="relative" data-controller="password-toggle">
          <%= f.input :password,
                      as: :password,
                      label: "New password",
                      required: true,
                      autocomplete: "new-password",
                      autocorrect: "off",
                      autocapitalize: "off",
                      spellcheck: "false",
                      input_html: {
                        class: "rounded-md border-gray-300 shadow-sm
                          focus:ring-blue-500 focus:border-blue-500
                          p-2 pr-10 w-full",
                        data: { password_toggle_target: "input" }
                      } %>

          <button
            type="button"
            class="toggle-password absolute right-3 top-9 text-gray-500 hover:text-gray-700"
            data-action="password-toggle#toggle"
            aria-label="Toggle password visibility">
            <i class="fa fa-eye" data-password-toggle-target="icon"></i>
          </button>
        </div>
      </div>

      <!-- CONFIRM PASSWORD -->
      <div class="flex flex-col relative" data-controller="password-toggle">
        <%= f.input :password_confirmation,
                    as: :password,
                    label: "New password confirmation",
                    autocomplete: "new-password",
                    autocorrect: "off",
                    autocapitalize: "off",
                    spellcheck: "false",
                    required: true,
                    input_html: {
                      class: "rounded-md border-gray-300 shadow-sm
                focus:ring-blue-500 focus:border-blue-500
                p-2 pr-10",
                      data: { password_toggle_target: "input" }
                    } %>

        <button
          type="button"
          class="toggle-password"
          data-action="password-toggle#toggle"
          aria-label="Toggle password visibility">
          <i class="fa fa-eye" data-password-toggle-target="icon"></i>
        </button>
      </div>

      <div class="mt-4 text-center">
        <%= f.submit "Change Password", class: "btn btn-primary" %>
      </div>

    <% end %>
  </div>
</div>
